@namespace RazorConsole.Components

@using System
@using System.Globalization
@using Microsoft.AspNetCore.Components
@using RazorConsole.Core.Rendering.ComponentMarkup

<div class="grid"
    data-columns="@ColumnAttribute"
    data-expand="@ExpandAttribute"
    data-width="@WidthAttribute">
    @ChildContent
</div>

@code {
    /// <summary>
    /// Arranges content in a multi-column grid using Spectre.Console's <see cref="global::Spectre.Console.Grid"/> renderable.
    /// </summary>
    /// <remarks>
    /// <para>
    /// Automatically arranges children into the specified number of columns, wrapping to new rows as needed (similar to CSS grid).
    /// </para>
    /// <para>
    /// See the <see href="https://spectreconsole.net/widgets/grid">Spectre.Console Grid documentation</see> for more information.
    /// </para>
    /// </remarks>

    /// <summary>
    /// Content to arrange in the grid.
    /// </summary>
    [Parameter]
    public RenderFragment? ChildContent { get; set; }

    /// <summary>
    /// Number of columns in the grid. Default is 2. Must be positive.
    /// </summary>
    [Parameter]
    public int Columns { get; set; } = 2;

    /// <summary>
    /// Whether the grid should expand to fill available space. Default is <c>false</c>.
    /// </summary>
    [Parameter]
    public bool Expand { get; set; }

    /// <summary>
    /// Width of the grid in characters. If <c>null</c>, automatically determined by content.
    /// </summary>
    [Parameter]
    public int? Width { get; set; }

    private string ColumnAttribute => Columns.ToString(CultureInfo.InvariantCulture);

    private string ExpandAttribute => Expand ? "true" : "false";

    private string? WidthAttribute => Width.HasValue && Width.Value > 0
        ? Width.Value.ToString(CultureInfo.InvariantCulture)
        : null;
}
