@namespace RazorConsole.Components

@using System.Collections.Generic
@using System.Globalization
@using System.Linq
@using System.Xml.Linq
@using Microsoft.AspNetCore.Components
@using RazorConsole.Core.Rendering.ComponentMarkup
@using Spectre.Console
@using Spectre.Console.Rendering
<div class="align"
     data-horizontal="@HorizontalAttribute"
     data-vertical="@VerticalAttribute"
     data-width="@WidthAttribute"
    data-height="@HeightAttribute">
    @ChildContent
</div>

@code {
    /// <summary>
    /// Aligns content horizontally and vertically within a container using Spectre.Console's <see cref="global::Spectre.Console.Align"/> renderable.
    /// </summary>
    /// <remarks>
    /// <para>
    /// Positions content within a specified area using horizontal (Left, Center, Right) and vertical (Top, Middle, Bottom) alignment options.
    /// </para>
    /// <para>
    /// See the <see href="https://spectreconsole.net/widgets/align">Spectre.Console Align documentation</see> for more information.
    /// </para>
    /// </remarks>

    /// <summary>
    /// Content to be aligned.
    /// </summary>
    [Parameter]
    public RenderFragment? ChildContent { get; set; }

    /// <summary>
    /// Horizontal alignment of the content. Default is <see cref="HorizontalAlignment.Left"/>.
    /// </summary>
    [Parameter]
    public HorizontalAlignment Horizontal { get; set; } = HorizontalAlignment.Left;

    /// <summary>
    /// Vertical alignment of the content. Default is <see cref="VerticalAlignment.Top"/>.
    /// </summary>
    [Parameter]
    public VerticalAlignment Vertical { get; set; } = VerticalAlignment.Top;

    /// <summary>
    /// Width of the alignment container in characters. If <c>null</c>, automatically determined by content.
    /// </summary>
    [Parameter]
    public int? Width { get; set; }

    /// <summary>
    /// Height of the alignment container in characters. If <c>null</c>, automatically determined by content.
    /// </summary>
    [Parameter]
    public int? Height { get; set; }

    private string HorizontalAttribute => Horizontal.ToString().ToLowerInvariant();

    private string VerticalAttribute => Vertical.ToString().ToLowerInvariant();

    private string? WidthAttribute => Width.HasValue && Width.Value > 0
        ? Width.Value.ToString(CultureInfo.InvariantCulture)
        : null;

    private string? HeightAttribute => Height.HasValue && Height.Value > 0
        ? Height.Value.ToString(CultureInfo.InvariantCulture)
        : null;
}
